{% from "_formhelpers.html" import render_unit_cell, render_unit_cell_units %}
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
    <h3>{{ item.sample }} - {{ item.type }}</h3>
  </div>
<div class="modal-body">
  <table class="table table-condensed">
    <tbody>
    {% for key in field_processing_overall -%}
      <tr>
        <td style="text-transform: capitalize;">{{ key|replace('_', ' ') }}</td>
        {% if item[key] is not string and item[key] is iterable %}
          <td>{{ render_unit_cell_units(item[key]) }}</td>
          {% else %}
            <td>{{ item[key] }} {%- if item[key] and name_unit[key] %} {{ name_unit[key] }} {% endif -%}</td>
        {% endif %}
      </tr>
    {%- endfor %}
    </tbody>
  </table>

  {%  if field_collection %}
  <table class="table table-condensed table-bordered">
    <tbody>
    <tr><th>Collection parameters</th></tr>
    {% for key in field_collection -%}
      <tr>
        <td style="text-transform: capitalize;">{{ key|replace('_', ' ') }}</td>
        <td>{{ item[key] }} {%- if item[key] and name_unit[key] %} {{ name_unit[key] }} {% endif -%}</td>
      </tr>
    {%- endfor %}
    </tbody>
  </table>
  {% endif %}

{%  if item.retrigger is defined %}
  <table class="table table-condensed table-bordered">
    <tbody>
    <tr><th>Retrigger parameters</th>
    <th>Value</th></tr>
    {% for key in field_retrigger %}
      <tr>
        <td style="text-transform: capitalize;">{{ key|replace('_', ' ') }}</td>
        {% if item.retrigger[key] is not string and item.retrigger[key] is iterable and item.retrigger[key] is defined%}
          <td>{{ render_unit_cell_units(item.retrigger[key]) }}</td>
        {% elif item.retrigger[key] is not defined %}
            <td>not set </td>
        {% else %}
            <td>{{ item.retrigger[key] }} {%- if item.retrigger[key] and name_unit[key] %} {{ name_unit[key] }} {% endif -%}</td>
        {% endif %}
      </tr>
    {%- endfor %}
    </tbody>
  </table>
{% endif %}

  {% if field_order -%}
  <table class="table table-condensed table-bordered">
    <thead>
      <tr>
        <th>&nbsp;</th>
        <th>Overall</th>
        <th>Low</th>
        <th>High</th>
      </tr>
    </thead>
    <tbody>
   {% for key in field_order -%}
      <tr>
        <td style="text-transform: capitalize;">{{ key|replace('_', ' ') }}</td>
        <td>{{ item[key][0] }} {%- if item[key][0] and name_unit[key] %} {{ name_unit[key] }} {% endif -%}</td>
        <td>{{ item[key][1] }} {%- if item[key][1] and name_unit[key] %} {{ name_unit[key] }} {% endif -%}</td>
        <td>{{ item[key][2] }} {%- if item[key][2] and name_unit[key] %} {{ name_unit[key] }} {% endif -%}</td>
      <tr>
    {%- endfor %}
   </tbody>
  </table>
  {%- endif %}
  </div>
  <div id="dataset-footer" class="modal-footer" data-bind="with: selectedRow">
    <button type="button" data-bind="click: $root.retrigger" class="btn btn-primary">Setup retriggering</button>
    <button type="button" data-dismiss="modal" class="btn">Close</button>
  </div>
</div> 
<script type="text/javascript">
ko.applyBindings(pageViewModel, document.getElementById('dataset-footer'));
</script>